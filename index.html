<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Word Bomb Learner</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg: radial-gradient(circle at top, #1a1f3c, #0b0d1a);
  --card: rgba(255,255,255,0.08);
  --text: #e8e8ff;
  --accent: #7f8cff;
}

body.light {
  --bg: #ffffff;
  --card: #f2f2f2;
  --text: #111;
  --accent: #5b6cff;
}

body.dark {
  --bg: #000;
  --card: #111;
  --text: #eee;
  --accent: #888;
}

body {
  margin: 0;
  min-height: 100vh;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  background: var(--card);
  padding: 20px;
  border-radius: 16px;
  width: min(420px, 90%);
  box-shadow: 0 20px 40px rgba(0,0,0,.4);
  text-align: center;
}

h1 {
  margin-top: 0;
}

input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}

button {
  background: var(--accent);
  color: #000;
  font-weight: bold;
  cursor: pointer;
}

.word {
  padding: 6px;
  border-bottom: 1px solid rgba(255,255,255,.1);
}

.highlight {
  background: var(--accent);
  color: #000;
  border-radius: 4px;
  padding: 0 2px;
}

.footer {
  margin-top: 10px;
  font-size: 12px;
  opacity: .6;
}

.notice {
  font-size: 12px;
  color: #f55;
  margin-bottom: 10px;
}
</style>
</head>

<body>
<div class="container">
  <div class="notice">
    To use the site properly, please request access here: 
    <a href="https://cors-anywhere.herokuapp.com/corsdemo" target="_blank" style="color: var(--accent);">CORS Demo</a>
  </div>

  <h1>Word Bomb Learner</h1>

  <input id="pattern" placeholder="Enter letters">

  <select id="filterMode">
    <option value="contains">Contains</option>
    <option value="starts">Starts With</option>
  </select>

  <select id="hyphenMode">
    <option value="casual">Casual Words</option>
    <option value="long">Long Words Only</option>
    <option value="hyphen">Hyphen Only</option>
  </select>

  <select id="mode" onchange="setTheme(this.value)">
    <option value="original">Original</option>
    <option value="dark">Dark</option>
    <option value="light">Light</option>
  </select>

  <div id="results"></div>

  <div class="footer">
    Made by r2ya1 â€” Ctrl to refresh active list
  </div>
</div>

<script>
let words = [];
let hyphenWords = [];
let lastPattern = "";
let lastMatches = [];

// Load full dictionary via CORS proxy
fetch("https://cors-anywhere.herokuapp.com/https://pages.cs.wisc.edu/~o-laughl/csw15.txt")
  .then(r => r.text())
  .then(text => { words = text.split("\n").map(w => w.trim().toLowerCase()).filter(Boolean); });

fetch("https://raw.githubusercontent.com/carreb/bombparty-practice/main/dict/hyphen-dict.txt")
  .then(r => r.text())
  .then(text => { hyphenWords = text.split("\n").map(w => w.trim().toLowerCase()).filter(Boolean); });

function shuffleArray(array) { return array.sort(() => Math.random() - 0.5); }

function highlightMatch(word, pattern){
  if(!pattern) return word;
  const regex = new RegExp(`(${pattern})`, 'gi');
  return word.replace(regex, '<span class="highlight">$1</span>');
}

function displayWords(matches){
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  const hyphenMode = document.getElementById("hyphenMode").value;

  // Filter hyphen words
  let hyphenList = [];
  if(hyphenMode === "casual") hyphenList = hyphenWords.filter(w=>w.length <=6 && w.includes(lastPattern));
  else if(hyphenMode === "long") hyphenList = hyphenWords.filter(w=>w.length >=8 && w.includes(lastPattern));
  else if(hyphenMode === "hyphen") hyphenList = hyphenWords.filter(w=>w.includes('-') && w.includes(lastPattern));

  const longest = [...matches].sort((a,b)=>b.length-a.length).slice(0,3);
  const shortest = [...matches].sort((a,b)=>a.length-b.length).slice(0,3);
  const random = shuffleArray(matches).slice(0,3);

  let sections = [];
  if(hyphenMode === "hyphen") {
    if(hyphenList.length) sections.push({title:"Hyphenated", list:hyphenList});
  } else {
    if(longest.length) sections.push({title:"Longest", list:longest});
    if(shortest.length) sections.push({title:"Shortest", list:shortest});
    if(hyphenList.length) sections.push({title:"Hyphenated", list:hyphenList});
    if(random.length) sections.push({title:"Random", list:random});
  }

  sections.forEach(sec=>{
    const secDiv = document.createElement("div");
    secDiv.className = "section";
    const h2 = document.createElement("h2");
    h2.textContent = sec.title;
    secDiv.appendChild(h2);
    sec.list.forEach(word=>{
      const wspan = document.createElement("span");
      wspan.className="word";
      wspan.innerHTML = highlightMatch(word, lastPattern);
      if(document.getElementById("mode").value === "original") wspan.classList.add("original");
      secDiv.appendChild(wspan);
    });
    resultsDiv.appendChild(secDiv);
  });
}

function findWords(){
  const pattern = document.getElementById("pattern").value.toLowerCase();
  const filterMode = document.getElementById("filterMode").value;
  if(!pattern){ document.getElementById("results").innerHTML=""; return; }
  lastPattern = pattern;

  if(filterMode === "contains") lastMatches = words.filter(w=>w.includes(pattern));
  else if(filterMode === "starts") lastMatches = words.filter(w=>w.startsWith(pattern));

  displayWords(lastMatches);
}

// Refresh active list with Left Ctrl
document.addEventListener("keydown", e=>{
  if(e.code === "ControlLeft" && lastMatches.length){
    displayWords(lastMatches);
  }
});

// Theme selector
function setTheme(value){
  document.body.className = value;
}

document.getElementById("pattern").addEventListener("input", findWords);
document.getElementById("filterMode").addEventListener("change", findWords);
document.getElementById("hyphenMode").addEventListener("change", findWords);
</script>
</body>
</html>
