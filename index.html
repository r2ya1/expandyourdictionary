<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Word Bomb Learner</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg: radial-gradient(circle at top, #1a1f3c, #0b0d1a);
  --card: rgba(255,255,255,0.08);
  --text: #e8e8ff;
  --accent: #7f8cff;
  --highlight-color: #ffeb3b; /* yellow highlight */
}

body.light {
  --bg: #ffffff;
  --card: #f2f2f2;
  --text: #111;
  --accent: #5b6cff;
  --highlight-color: #ffeb3b;
}

body.dark {
  --bg: #000;
  --card: #111;
  --text: #eee;
  --accent: #888;
  --highlight-color: #ffeb3b;
}

body {
  margin: 0;
  min-height: 100vh;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  background: var(--card);
  padding: 20px;
  border-radius: 16px;
  width: min(420px, 90%);
  box-shadow: 0 20px 40px rgba(0,0,0,.4);
  text-align: center;
}

h1 {
  margin-top: 0;
}

input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}

button {
  background: var(--accent);
  color: #000;
  font-weight: bold;
  cursor: pointer;
}

.word {
  padding: 6px;
  display: inline-block;
  margin: 2px;
  border-radius: 4px;
  border-bottom: 1px solid rgba(255,255,255,.1);
}

.highlight {
  background: var(--highlight-color);
  color: #000;
  border-radius: 2px;
  padding: 0 2px;
}

.footer {
  margin-top: 10px;
  font-size: 12px;
  opacity: .6;
}

.notice {
  font-size: 12px;
  color: #f55;
  margin-bottom: 10px;
}
</style>
</head>

<body>
<div class="container">
  <h1>Word Bomb Learner</h1>

  <input id="pattern" placeholder="Enter letters">

  <select id="filterMode">
    <option value="contains">Contains</option>
    <option value="starts">Starts With</option>
  </select>

  <select id="hyphenMode">
    <option value="casual">Casual Words</option>
    <option value="long">Long Words Only</option>
    <option value="hyphen">Hyphen Only</option>
  </select>

  <select id="mode" onchange="setTheme(this.value)">
    <option value="original">Original</option>
    <option value="dark">Dark</option>
    <option value="light">Light</option>
  </select>

  <div id="results"></div>

  <div class="footer">
    Made by r2ya1 â€” Ctrl to refresh active list
  </div>
</div>

<script>
let words = [];
let hyphenWords = [];
let lastPattern = "";
let lastMatches = [];
let lastHyphenMatches = [];

// Load dictionary
fetch("https://raw.githubusercontent.com/r2ya1/expandyourdictionary/main/assets.json")
  .then(response => {
    if (!response.ok) throw new Error("Network response was not ok");
    return response.json();
  })
  .then(obj => {
    const decoded = atob(obj.data);

    // Main word list
    words = JSON.parse(decoded).map(w => w.toLowerCase());

    // âœ… Extract hyphenated words ONCE
    hyphenWords = words.filter(w => w.includes("-"));

    console.log("âœ… Dictionary loaded:", words.length, "words");
    console.log("ðŸ”— Hyphen words:", hyphenWords.length);
    console.log("Hyphen sample:", hyphenWords.slice(0, 5));
  })
  .catch(err => console.error("âŒ Failed to load dictionary:", err));

function shuffleArray(array) {
  return array.sort(() => Math.random() - 0.5);
}

function highlightMatch(word, pattern){
  if(!pattern) return word;
  const regex = new RegExp(`(${pattern})`, 'gi');
  return word.replace(regex, '<span class="highlight">$1</span>');
}

function displayWords(matches, hyphenList){
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "";

  const hyphenMode = document.getElementById("hyphenMode").value;

  // Limit hyphen list to 3
  if(hyphenMode === "hyphen") hyphenList = hyphenList.slice(0,3);

  const longest = [...matches].sort((a,b)=>b.length-a.length).slice(0,3);
  const shortest = [...matches].sort((a,b)=>a.length-b.length).slice(0,3);
  const random = shuffleArray(matches).slice(0,3);

  let sections = [];

  if(hyphenMode === "hyphen") {
    if(hyphenList.length)
      sections.push({ title:"Hyphenated", list: hyphenList });
  } else {
    if(longest.length) sections.push({ title:"Longest", list: longest });
    if(shortest.length) sections.push({ title:"Shortest", list: shortest });
    if(hyphenList.length) sections.push({ title:"Hyphenated", list: hyphenList.slice(0,3) });
    if(random.length) sections.push({ title:"Random", list: random });
  }

  sections.forEach(sec=>{
    const secDiv = document.createElement("div");
    const h2 = document.createElement("h2");
    h2.textContent = sec.title;
    secDiv.appendChild(h2);

    sec.list.forEach(word=>{
      const wspan = document.createElement("span");
      wspan.className = "word";
      wspan.innerHTML = highlightMatch(word, lastPattern);
      secDiv.appendChild(wspan);
    });

    resultsDiv.appendChild(secDiv);
  });
}

function filterHyphenWords(pattern){
  const hyphenMode = document.getElementById("hyphenMode").value;
  const filterMode = document.getElementById("filterMode").value;

  let filtered = hyphenWords;

  // Pattern filter
  if(filterMode === "contains") {
    filtered = filtered.filter(w => w.includes(pattern));
  } else {
    filtered = filtered.filter(w => w.startsWith(pattern));
  }

  // Length rules
  if(hyphenMode === "casual") {
    filtered = filtered.filter(w => w.length <= 8);
  }
  else if(hyphenMode === "long") {
    filtered = filtered.filter(w => w.length >= 10);
  }
  // hyphen mode = already filtered

  return shuffleArray(filtered);
}

function findWords(){
  const pattern = document.getElementById("pattern").value.toLowerCase();
  const filterMode = document.getElementById("filterMode").value;

  if(!pattern){
    document.getElementById("results").innerHTML = "";
    return;
  }

  lastPattern = pattern;

  if(filterMode === "contains") {
    lastMatches = words.filter(w => w.includes(pattern));
  } else {
    lastMatches = words.filter(w => w.startsWith(pattern));
  }

  lastHyphenMatches = filterHyphenWords(pattern);
  displayWords(lastMatches, lastHyphenMatches);
}

// Ctrl refresh
document.addEventListener("keydown", e=>{
  if(e.code === "ControlLeft" && lastPattern){
    lastHyphenMatches = filterHyphenWords(lastPattern);
    displayWords(lastMatches, lastHyphenMatches);
  }
});

// Theme switch
function setTheme(value){
  document.body.className = value;
}

document.getElementById("pattern").addEventListener("input", findWords);
document.getElementById("filterMode").addEventListener("change", findWords);
document.getElementById("hyphenMode").addEventListener("change", findWords);
</script>
</body>
</html>
